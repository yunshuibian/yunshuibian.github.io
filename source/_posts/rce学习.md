---
title: rce学习
date: 2025-01-29 17:50:15
tags:
categories:
  学习

---

# rce命令执行漏洞

在配置docker源得时候尝试一天发现只有下面才可成功

{
  "registry-mirrors": [
    "https://docker.1ms.run",
    "https://hub.rat.dev",
    "https://docker.1panel.live"
  ]
}

来源于该博客
[kali下Docker详细安装、docker-compose安装_kali安装docker-CSDN博客](https://blog.csdn.net/m0_56373528/article/details/144637606)

橙子科技靶场搭建指令：sudo docker run -p 18022:22 -p 18080:80 -p 18081:81 -p 18082:82 -p 18085:85 -i -t mcc0624/cmd:latest bash -c '/etc/rc.local; /bin/bash'

![image-20250119172619012](rce学习/image-20250119172619012.png)

# 命令执行函数

## 1、system

可以直接回显对应的结果

![](rce学习/image-20250120221539694.png)

## 2、exec

该函数有两个参数，第一个参数为指令，第二个参数为一个变量，如果没有第二个参数那么其指令只会回显最后一行，如果有第二个参数那么其指令结果会以数组的方式全部回显。

![image-20250120224126367](rce学习/image-20250120224126367.png)

## 3、passthru

 该函数输出得为二进制数据，有两个参数，第一个为命令与system相同

![image-20250121223255856](rce学习/image-20250121223255856.png)

## 4、shell_exec

与反引号相同，没有返回值需要使用echo等函数将命令结果展现出来

![image-20250121223933918](rce学习/image-20250121223933918.png)

## 5、popen

有两个参数，可以看作该函数将第一个参数命令得结果写成一个文档，第二关参数为权限

![image-20250121224449617](rce学习/image-20250121224449617.png)

## 6、proc_open

与上方函数一样没有回显

![image-20250121224958502](rce学习/image-20250121224958502.png)

## 7、pctntl_exec

![image-20250121225803936](rce学习/image-20250121225803936.png)

# LD_PRELOAD绕过

该方法与upload中上传.user.ini文件类似通过上传文件来更改环境运行的情况

![image-20250124223526169](rce学习/image-20250124223526169.png)

动态链接即使用外界的库进行调用其存在危险



![image-20250124223719184](rce学习/image-20250124223719184.png)

更改getuid的指令来进行操作

![image-20250124223854259](rce学习/image-20250124223854259.png)

在执行前 先加载demo中的内容

![image-20250124224351619](rce学习/image-20250124224351619.png)

上传条件能够进行文件上传能够控制环境变量即可

# pcntl绕过

![image-20250124224449570](rce学习/image-20250124224449570.png)

或者使用shell反弹即可进行



# 链接符绕过

使用&& || ;等链接符绕过即可

# 空格过滤绕过

![image-20250124233122732](rce学习/image-20250124233122732.png)

注意url编码绕过使用tab键即可

# 文件名绕过

使用通配符绕过

单引号双引号绕过也可

反斜线绕过将特殊字符当成字符串\

特殊变量绕过

![image-20250124233541913](rce学习/image-20250124233541913.png)

![image-20250124233604120](rce学习/image-20250124233604120.png)

# 文件读取绕过

![image-20250124233645724](rce学习/image-20250124233645724.png)

使用其余的文件读取命令即可

# 编码绕过

![image-20250124233803638](rce学习/image-20250124233803638.png)

base64绕过![image-20250124233943683](rce学习/image-20250124233943683.png)

使用管道输出符进行绕过

# 时间盲注

![image-20250124234024237](rce学习/image-20250124234024237.png)

与sql注入中的时间盲注逻辑相同通过逻辑判断来确定获取到的信息正确与否

![image-20250124234408968](rce学习/image-20250124234408968.png)

![image-20250124234448060](rce学习/image-20250124234448060.png)

根据这些语句进行判断即可

# 长度过滤



![image-20250124234843695](rce学习/image-20250124234843695.png)

使用指令生成一个一个的小文件

![image-20250124235139104](rce学习/image-20250124235139104.png)

然后将其安装时间进行排序

![image-20250124235259023](rce学习/image-20250124235259023.png)

使用dir进行命令的输出即可

# 无参数rce

![image-20250125103807886](rce学习/image-20250125103807886.png)

## http请求头绕过

![image-20250125103904287](rce学习/image-20250125103904287.png)

正则表达式

![image-20250125110314830](rce学习/image-20250125110314830.png)

无参数rce只能执行没有参数的函数

![image-20250125220623477](rce学习/image-20250125220623477.png)

![image-20250125224213800](rce学习/image-20250125224213800.png)

![image-20250125224226823](rce学习/image-20250125224226823.png)

gerallheaders拿到的是从下往上拿；

之后利用bp进行更改即可![image-20250125231212142](rce学习/image-20250125231212142.png)

## 无参数全局变量rce

 

![image-20250125231746405](rce学习/image-20250125231746405.png)

![image-20250125232540443](rce学习/image-20250125232540443.png)

## 无参数session

该版本使用php7以上版本

![image-20250125232746859](rce学习/image-20250125232746859.png)

![image-20250125233238321](rce学习/image-20250125233238321.png)

show_source可以读取文件的内容

![image-20250125233425685](rce学习/image-20250125233425685.png)

![image-20250125233439917](rce学习/image-20250125233439917.png)

## 无参数scandir读取

![image-20250125233804030](rce学习/image-20250125233804030.png)

![image-20250125234616264](rce学习/image-20250125234616264.png)

使用指令一步一步查看文件内容

![image-20250125234648250](rce学习/image-20250125234648250.png)

![image-20250125234948451](rce学习/image-20250125234948451.png)

# 无字母数字绕过

## 异或绕过

![image-20250126160817410](rce学习/image-20250126160817410.png)

无法上传数字和字母

注意上传参数时+会被识别为空格，使用url编码即可

assert函数

![image-20250126164043875](rce学习/image-20250126164043875.png)

post上传参数指令，

?cmd=$_="!((%)("^"@[[@[\\";$__="!+/(("^"~{`{|";$___=$$__;$_($___['_']);

## 取反绕过

![image-20250126170908677](rce学习/image-20250126170908677.png)

![image-20250126171243949](rce学习/image-20250126171243949.png)

poc构建

![image-20250126171321084](rce学习/image-20250126171321084.png)

## 自增绕过

## 无字母数字符号绕过

# ![image-20250126175612452](rce学习/image-20250126175612452.png)

与sql注入相同使用>先进行闭合

![image-20250126181059606](rce学习/image-20250126181059606.png)

![image-20250126181121238](rce学习/image-20250126181121238.png)

